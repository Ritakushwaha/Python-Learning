{
    "size":5,
    "query":{
       "bool":{
          "must":[
             {
                "query_string":{
                   "query":"kubernetes.labels.app= \"cms\" AND (severity: \"error\")",
                   "fields":[
                      
                   ],
                   "type":"best_fields",
                   "default_operator":"or",
                   "max_determinized_states":10000,
                   "enable_position_increments":true,
                   "fuzziness":"AUTO",
                   "fuzzy_prefix_length":0,
                   "fuzzy_max_expansions":50,
                   "phrase_slop":0,
                   "analyze_wildcard":true,
                   "time_zone":"Europe/Stockholm",
                   "escape":false,
                   "auto_generate_synonyms_phrase_query":true,
                   "fuzzy_transpositions":true,
                   "boost":1.0
                }
             }
          ],
          "filter":[
             {
                "range":{
                   "@timestamp":{
                      "from":"now-5m",
                      "to":"now",
                      "include_lower":true,
                      "include_upper":true,
                      "boost":1.0
                   }
                }
             }
          ],
          "adjust_pure_negative":true,
          "boost":1.0
       }
    },
    "version":true,
    "_source":false,
    "fields":[
       {
          "field":"clientinfo"
       },
       {
          "field":"realm"
       },
       {
          "field":"message"
       },
       {
          "field":"kubernetes.namespace_name"
       },
       {
          "field":"severity"
       },
       {
          "field":"@timestamp",
          "format":"epoch_millis"
       }
    ],
    "sort":[
       {
          "@timestamp":{
             "order":"desc",
             "unmapped_type":"boolean"
          }
       }
    ],
    "aggregations":{
       "realms":{
          "terms":{
             "field":"realm",
             "size":10,
             "min_doc_count":1,
             "shard_min_doc_count":0,
             "show_term_doc_count_error":false,
             "order":[
                {
                   "_count":"desc"
                },
                {
                   "_key":"asc"
                }
             ]
          }
       },
       "messages":{
          "terms":{
             "field":"message.keyword",
             "size":5,
             "min_doc_count":1,
             "shard_min_doc_count":0,
             "show_term_doc_count_error":false,
             "order":[
                {
                   "_count":"desc"
                },
                {
                   "_key":"asc"
                }
             ]
          }
       },
       "level":{
          "terms":{
             "field":"severity",
             "size":1,
             "min_doc_count":1,
             "shard_min_doc_count":0,
             "show_term_doc_count_error":false,
             "order":[
                {
                   "_count":"desc"
                },
                {
                   "_key":"asc"
                }
             ]
          }
       }
    }
 }